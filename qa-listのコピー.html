<!DOCTYPE html>
<html>
    <html lang="ja">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <style>
            /* Hiding the checkbox, but allowing it to be focused */
            .badgebox
            {
                opacity: 0;
            }

            .badgebox + .badge
            {
                /* Move the check mark away when unchecked */
                text-indent: -999999px;
                /* Makes the badge's width stay the same checked and unchecked */
                width: 27px;
            }

            .badgebox:focus + .badge
            {
                /* Set something to make the badge looks focused */
                /* This really depends on the application, in my case it was: */

                /* Adding a light border */
                box-shadow: inset 0px 0px 5px;
                /* Taking the difference out of the padding */
            }

            .badgebox:checked + .badge
            {
                /* Move the check mark back when checked */
                text-indent: 0;
            }


        </style>

        <title>QA一覧</title>
    </head>

    <body>

        <div class="container">
            <div class="row text-center">
                <h1>QA一覧</h1>
                <br/>
            </div>
        </div>

        <!--ラベル表示部分-->
        <div class="container">
            <div class="row text-center" id="selectLabel">

            </div>
        </div>

        <div class="container">
            <!--表示件数部分-->
            <div class="row">
                <div class="col-xs-6 col-md-3">
                    <form class="form-horizontal">
                        <div class="container">
                            <div class="form-group form-group-sm">
                                <div class="col-md-6">
                                    <br/>
                                    <label class="col-sm-3 control-label" for="usage2select3">表示件数</label>
                                    <div class="col-sm-3">
                                        <select class="form-control" id="usage2select3">
                                            <option>10</option>
                                            <option selected>20</option>
                                            <option>30</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!--ソート部分-->
                <div class="col-xs-6 col-md-3">
                    <form class="form-horizontal">
                        <div class="container">
                            <div class="form-group form-group-sm">
                                <div class="col-md-6">
                                    <br/>
                                    <label class="col-sm-3 control-label" for="usage2select3">ソート順</label>
                                    <div class="col-sm-3">
                                        <select class="form-control1" id="sort">
                                            <option selected value="desc">起票の新しい順</option>
                                            <option value="asc">起票の古い順</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!--オープン選択部分-->
                <div class="col-xs-6 col-md-3">
                    <form class="form-horizontal">
                        <div class="container">
                            <div class="form-group form-group-sm">
                                <div class="col-md-6">
                                    <br/>
                                    <label class="col-sm-3 control-label" for="usage2select3">オープンのみ</label>
                                    <div class="col-sm-2">
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                <input type="checkbox" id="openCheck">
                                                <span class="cr"><i class="cr-icon fa fa-check"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>


                <div class="col-xs-6 col-md-3">
                    <form class="form-horizontal">
                        <div class="container">
                            <div class="form-group form-group-sm">
                                <div class="col-md-6">
                                    <br/>
                                    <div class="col-sm-3">
                                        <div style="display:inline-flex">
                                            <form action="javascript:width_input();" style="display: inline">
                                                <input type="search" name="search">
                                                <input type="button" name="submit" value="検索" id="search">
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

            </div>
        </div>

        <!--テーブル部分-->
        <div class="container">
            <br>
            <table class="table table-bordered" id="tableContent">
                <thead>
                    <tr align="center">
                        <th>タイトル</th>
                        <th class="col-md-1">リンク</th>
                        <th class="col-md-2">起票者</th>
                    </tr>
                </thead>

                <tbody id="showPart">

                </tbody>
            </table>
        </div>

    </body>



    <script>
        var currentPage,
            labelCheck = [],
            labelFlag = false,
            labelName,
            sortKind = "desc",
            searchKeyword,
            openStatus;


        <!--テーブルの要素を削除-->
        function deleteTableContent() {
            $('#showPart').children().remove();
        }

        <!--ガイドのラベル表示-->
        function showLabels() {
            $.ajax({
                url:'https://gitlab.com/api/v4/projects/4907483/labels',
                type:'get',
                dataType:'json',
                async: false,
                headers:{
                    'Private-Token':'Q862NkCEozLwmTpt6V29'
                }
            })
            .done(function(json) {
                $.each(json, function(index, item){
                    $("#selectLabel").append('<label for="' + item.name + '" class="btn btn-primary" style="background-color:' + item.color + '">' + item.name + '<input type="radio" id="' + item.name + '" val="' + item.name + '" class="badgebox" name="check"><span class="badge">&check;</span></label>');
                });
            });
        }

        function getApi(args) {
            $.ajax({
                url:'https://gitlab.com/api/v4/projects/4907483/' + args,
                type:'get',
                dataType:'json',
                async: false,
                headers:{
                    'Private-Token':'Q862NkCEozLwmTpt6V29'
                }
            })
            .done(function(json) {
                deleteTableContent();
                $.each(json, function(index, item){
                    $("#showPart").append('<tr><td>' + item.title + '</td><td><a href="' + item.web_url + '" target=_blank><img src="detail.jpg" alt="詳細"></a></td><td>' + item.author.name + '</td></tr>');
                });
            });
        }

        function selectLabel() {
            $('.badgebox').change(function() {
                labelName = $(this).attr('id');
                getApi('issues?labels=' + labelName);
            });
        }

        function sortTable() {
            $('#sort').change(function() {
                sortKind=$(this).val();
                getApi('issues?sort=' + sortKind + '&labels=' + labelName);
            });
        }

        function selectOpen() {
            $("#openCheck").change(function () {
                //チェックボックスの現在のステータスを取得
                openStatus = $("#openCheck").prop("checked");

                //取得したステータスが true なら false を、 false なら true をセットする
                if(openStatus){
                    //チェックボックスをOFFにする（チェックを外す）。
                    getApi('issues?state=opened&labels=' + labelName);

                }else{
                    //チェックボックスをONにする（チェックする）。
                    getApi('issues?labels=' + labelName);
                    <!--$("#openCheck").prop("checked", true);-->
                }
            });
        }

        function keywordSearch() {
            $("#search").on("click",function(){
                alert(123);


            });


        }


        function searchKeyword() {
        }

        $(document).ready(function(){
            showLabels();
            selectLabel();
            sortTable();
            selectOpen();
            keywordSearch();
        });

    </script>
</html>